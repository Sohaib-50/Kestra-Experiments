import json
from datetime import datetime


def clean_and_prepare_data(scan_result):

    # Extract required fields
    ip_address = scan_result['nmaprun']['host']['address']['addr']

    hostname = scan_result['nmaprun']['hostnames']['hostname'][0]['name'] if scan_result['nmaprun']['hostnames']['hostname'] else None
    os_name = scan_result['nmaprun']['host']['os']['osmatch'][0]['name']
    os_version = scan_result['nmaprun']['host']['os']['osmatch'][0]['osgen']
    operating_system = scan_result['nmaprun']['host']['os']['osfamily']
    uptime_seconds = scan_result['nmaprun']['host']['uptime']['seconds']
    last_boot = scan_result['nmaprun']['host']['uptime']['lastboot']
    scanned_at = datetime.now()

    # Prepare ports data
    ports = []
    for port in scan_result['nmaprun']['host']['ports']['port']:
        ports.append({
            'portid': port['portid'],
            'protocol': port['protocol'],
            'state': port['state']['state'],
            'service': {
                'product': port['service']['product'],
                'version': port['service']['version'],
                'extrainfo': port['service'].get('extrainfo', '')
            }
        })

    # Prepare extra_info
    extra_info = json.dumps(scan_result['nmaprun'])

    return {
        'ip_address': ip_address,
        'hostname': hostname,
        'os_name': os_name,
        'os_version': os_version,
        'operating_system': operating_system,
        'uptime_seconds': uptime_seconds,
        'last_boot': last_boot,
        'scanned_at': scanned_at,
        'ports': ports,
        'extra_info': extra_info
    }


scan_result = json.loads("""{"nmaprun":{"args":"/usr/bin/nmap -O -sV -oX /output/res.xml 172.31.95.68","hosthint":{"address":{"addrtype":"ipv4","addr":"172.31.95.68"},"hostnames":"","status":{"reason":"unknown-response","reason_ttl":0,"state":"up"}},"startstr":"Fri Nov  1 06:19:23 2024","xmloutputversion":1.05,"scanner":"nmap","start":1730441963,"host":{"address":{"addrtype":"ipv4","addr":"172.31.95.68"},"os":{"portused":[{"proto":"tcp","state":"open","portid":22},{"proto":"tcp","state":"closed","portid":1},{"proto":"udp","state":"closed","portid":37208}],"osmatch":[{"osclass":[{"vendor":"Linux","accuracy":100,"cpe":"cpe:/o:linux:linux_kernel:4","type":"general purpose","osgen":"4.X","osfamily":"Linux"},{"vendor":"Linux","accuracy":100,"cpe":"cpe:/o:linux:linux_kernel:5","type":"general purpose","osgen":"5.X","osfamily":"Linux"}],"line":70534,"name":"Linux 4.15 - 5.19","accuracy":100},{"osclass":{"vendor":"Linux","accuracy":100,"cpe":"cpe:/o:linux:linux_kernel:5.4","type":"general purpose","osgen":"5.X","osfamily":"Linux"},"line":72530,"name":"OpenWrt 21.02 (Linux 5.4)","accuracy":100}]},"distance":{"value":1},"endtime":1730441976,"hostnames":{"hostname":{"name":"ip-172-31-95-68.ec2.internal","type":"PTR"}},"tcpsequence":{"difficulty":"Good luck!","values":"19D8E654,D48C41D,2A21B695,BCF515C,FE9B6A2F,70B1E4A4","index":262},"starttime":1730441963,"ports":{"extraports":{"extrareasons":{"reason":"reset","proto":"tcp","count":997,"ports":"1,3-4,6-7,9,13,17,19-21,23-26,30,32-33,37,42-43,49,53,70,79-85,88-90,99-100,106,109-111,113,119,125,135,139,143-144,146,161,163,179,199,211-212,222,254-256,259,264,280,301,306,311,340,366,389,406-407,416-417,425,427,443-445,458,464-465,481,497,500,512-515,524,541,543-545,548,554-555,563,587,593,616-617,625,631,636,646,648,666-668,683,687,691,700,705,711,714,720,722,726,749,765,777,783,787,800-801,808,843,873,880,888,898,900-903,911-912,981,987,990,992-993,995,999-1002,1007,1009-1011,1021-1100,1102,1104-1108,1110-1114,1117,1119,1121-1124,1126,1130-1132,1137-1138,1141,1145,1147-1149,1151-1152,1154,1163-1166,1169,1174-1175,1183,1185-1187,1192,1198-1199,1201,1213,1216-1218,1233-1234,1236,1244,1247-1248,1259,1271-1272,1277,1287,1296,1300-1301,1309-1311,1322,1328,1334,1352,1417,1433-1434,1443,1455,1461,1494,1500-1501,1503,1521,1524,1533,1556,1580,1583,1594,1600,1641,1658,1666,1687-1688,1700,1717-1721,1723,1755,1761,1782-1783,1801,1805,1812,1839-1840,1862-1864,1875,1900,1914,1935,1947,1971-1972,1974,1984,1998-2010,2013,2020-2022,2030,2033-2035,2038,2040-2043,2045-2049,2065,2068,2099-2100,2103,2105-2107,2111,2119,2121,2126,2135,2144,2160-2161,2170,2179,2190-2191,2196,2200,2222,2251,2260,2288,2301,2323,2366,2381-2383,2393-2394,2399,2401,2492,2500,2522,2525,2557,2601-2602,2604-2605,2607-2608,2638,2701-2702,2710,2717-2718,2725,2800,2809,2811,2869,2875,2909-2910,2920,2967-2968,2998,3000-3001,3003,3005-3006,3011,3017,3030-3031,3052,3071,3077,3128,3168,3211,3221,3260-3261,3268-3269,3283,3300-3301,3306,3322-3325,3333,3351,3367,3369-3372,3389-3390,3404,3476,3493,3517,3527,3546,3551,3580,3659,3689-3690,3703,3737,3766,3784,3800-3801,3809,3814,3826-3828,3851,3869,3871,3878,3880,3889,3905,3914,3918,3920,3945,3971,3986,3995,3998,4000-4006,4045,4111,4125-4126,4129,4224,4242,4279,4321,4343,4443-4446,4449,4550,4567,4662,4848,4899-4900,4998,5000-5004,5009,5030,5033,5050-5051,5054,5060-5061,5080,5087,5100-5102,5120,5190,5200,5214,5221-5222,5225-5226,5269,5280,5298,5357,5405,5414,5431-5432,5440,5500,5510,5544,5550,5555,5560,5566,5631,5633,5666,5678-5679,5718,5730,5800-5802,5810-5811,5815,5822,5825,5850,5859,5862,5877,5900-5904,5906-5907,5910-5911,5915,5922,5925,5950,5952,5959-5963,5985-5989,5998-6007,6009,6025,6059,6100-6101,6106,6112,6123,6129,6156,6346,6389,6502,6510,6543,6547,6565-6567,6580,6646,6666-6669,6689,6692,6699,6779,6788-6789,6792,6839,6881,6901,6969,7000-7002,7004,7007,7019,7025,7070,7100,7103,7106,7200-7201,7402,7435,7443,7496,7512,7625,7627,7676,7741,7777-7778,7800,7911,7920-7921,7937-7938,7999-8002,8007-8011,8021-8022,8031,8042,8045,8081,8083-8090,8093,8099-8100,8180-8181,8192-8194,8200,8222,8254,8290-8292,8300,8333,8383,8400,8402,8443,8500,8600,8649,8651-8652,8654,8701,8800,8873,8888,8899,8994,9000-9003,9009-9011,9040,9050,9071,9080-9081,9090-9091,9099-9103,9110-9111,9200,9207,9220,9290,9415,9418,9485,9500,9502-9503,9535,9575,9593-9595,9618,9666,9876-9878,9898,9900,9917,9929,9943-9944,9968,9998-10004,10009-10010,10012,10024-10025,10082,10180,10215,10243,10566,10616-10617,10621,10626,10628-10629,10778,11110-11111,11967,12000,12174,12265,12345,13456,13722,13782-13783,14000,14238,14441-14442,15000,15002-15004,15660,15742,16000-16001,16012,16016,16018,16080,16113,16992-16993,17877,17988,18040,18101,18988,19101,19283,19315,19350,19780,19801,19842,20000,20005,20031,20221-20222,20828,21571,22939,23502,24444,24800,25734-25735,26214,27000,27352-27353,27355-27356,27715,28201,30000,30718,30951,31038,31337,32768-32785,33354,33899,34571-34573,35500,38292,40193,40911,41511,42510,44176,44442-44443,44501,45100,48080,49152-49161,49163,49165,49167,49175-49176,49400,49999-50003,50006,50300,50389,50500,50636,50800,51103,51493,52673,52822,52848,52869,54045,54328,55055-55056,55555,55600,56737-56738,57294,57797,58080,60020,60443,61532,61900,62078,63331,64623,64680,65000,65129,65389"},"count":997,"state":"closed"},"port":[{"protocol":"tcp","service":{"product":"OpenSSH","method":"probed","name":"ssh","cpe":["cpe:/a:openbsd:openssh:8.9p1","cpe:/o:linux:linux_kernel"],"conf":10,"ostype":"Linux","version":"8.9p1 Ubuntu 3ubuntu0.10","extrainfo":"Ubuntu Linux; protocol 2.0"},"state":{"reason":"syn-ack","reason_ttl":64,"state":"open"},"portid":22},{"protocol":"tcp","service":{"product":"Apache Tomcat","method":"probed","name":"http","cpe":"cpe:/a:apache:tomcat","conf":10,"extrainfo":"language: en"},"state":{"reason":"syn-ack","reason_ttl":64,"state":"open"},"portid":8080},{"protocol":"tcp","service":{"product":"Apache Tomcat","method":"probed","name":"http","cpe":"cpe:/a:apache:tomcat","conf":10,"extrainfo":"language: en"},"state":{"reason":"syn-ack","reason_ttl":64,"state":"open"},"portid":8082}]},"uptime":{"lastboot":"Fri Nov  1 01:56:41 2024","seconds":15775},"times":{"rttvar":16,"srtt":65,"to":100000},"tcptssequence":{"values":"F0AE2D,F0AE91,F0AEF5,F0AF5A,F0AFBE,F0B022","class":"1000HZ"},"ipidsequence":{"values":"0,0,0,0,0,0","class":"All zeros"},"status":{"reason":"echo-reply","reason_ttl":64,"state":"up"}},"debugging":{"level":0},"runstats":{"hosts":{"total":1,"up":1,"down":0},"finished":{"summary":"Nmap done at Fri Nov  1 06:19:36 2024; 1 IP address (1 host up) scanned in 13.22 seconds","elapsed":13.22,"exit":"success","time":1730441976,"timestr":"Fri Nov  1 06:19:36 2024"}},"version":7.95,"scaninfo":{"protocol":"tcp","numservices":1000,"services":"1,3-4,6-7,9,13,17,19-26,30,32-33,37,42-43,49,53,70,79-85,88-90,99-100,106,109-111,113,119,125,135,139,143-144,146,161,163,179,199,211-212,222,254-256,259,264,280,301,306,311,340,366,389,406-407,416-417,425,427,443-445,458,464-465,481,497,500,512-515,524,541,543-545,548,554-555,563,587,593,616-617,625,631,636,646,648,666-668,683,687,691,700,705,711,714,720,722,726,749,765,777,783,787,800-801,808,843,873,880,888,898,900-903,911-912,981,987,990,992-993,995,999-1002,1007,1009-1011,1021-1100,1102,1104-1108,1110-1114,1117,1119,1121-1124,1126,1130-1132,1137-1138,1141,1145,1147-1149,1151-1152,1154,1163-1166,1169,1174-1175,1183,1185-1187,1192,1198-1199,1201,1213,1216-1218,1233-1234,1236,1244,1247-1248,1259,1271-1272,1277,1287,1296,1300-1301,1309-1311,1322,1328,1334,1352,1417,1433-1434,1443,1455,1461,1494,1500-1501,1503,1521,1524,1533,1556,1580,1583,1594,1600,1641,1658,1666,1687-1688,1700,1717-1721,1723,1755,1761,1782-1783,1801,1805,1812,1839-1840,1862-1864,1875,1900,1914,1935,1947,1971-1972,1974,1984,1998-2010,2013,2020-2022,2030,2033-2035,2038,2040-2043,2045-2049,2065,2068,2099-2100,2103,2105-2107,2111,2119,2121,2126,2135,2144,2160-2161,2170,2179,2190-2191,2196,2200,2222,2251,2260,2288,2301,2323,2366,2381-2383,2393-2394,2399,2401,2492,2500,2522,2525,2557,2601-2602,2604-2605,2607-2608,2638,2701-2702,2710,2717-2718,2725,2800,2809,2811,2869,2875,2909-2910,2920,2967-2968,2998,3000-3001,3003,3005-3006,3011,3017,3030-3031,3052,3071,3077,3128,3168,3211,3221,3260-3261,3268-3269,3283,3300-3301,3306,3322-3325,3333,3351,3367,3369-3372,3389-3390,3404,3476,3493,3517,3527,3546,3551,3580,3659,3689-3690,3703,3737,3766,3784,3800-3801,3809,3814,3826-3828,3851,3869,3871,3878,3880,3889,3905,3914,3918,3920,3945,3971,3986,3995,3998,4000-4006,4045,4111,4125-4126,4129,4224,4242,4279,4321,4343,4443-4446,4449,4550,4567,4662,4848,4899-4900,4998,5000-5004,5009,5030,5033,5050-5051,5054,5060-5061,5080,5087,5100-5102,5120,5190,5200,5214,5221-5222,5225-5226,5269,5280,5298,5357,5405,5414,5431-5432,5440,5500,5510,5544,5550,5555,5560,5566,5631,5633,5666,5678-5679,5718,5730,5800-5802,5810-5811,5815,5822,5825,5850,5859,5862,5877,5900-5904,5906-5907,5910-5911,5915,5922,5925,5950,5952,5959-5963,5985-5989,5998-6007,6009,6025,6059,6100-6101,6106,6112,6123,6129,6156,6346,6389,6502,6510,6543,6547,6565-6567,6580,6646,6666-6669,6689,6692,6699,6779,6788-6789,6792,6839,6881,6901,6969,7000-7002,7004,7007,7019,7025,7070,7100,7103,7106,7200-7201,7402,7435,7443,7496,7512,7625,7627,7676,7741,7777-7778,7800,7911,7920-7921,7937-7938,7999-8002,8007-8011,8021-8022,8031,8042,8045,8080-8090,8093,8099-8100,8180-8181,8192-8194,8200,8222,8254,8290-8292,8300,8333,8383,8400,8402,8443,8500,8600,8649,8651-8652,8654,8701,8800,8873,8888,8899,8994,9000-9003,9009-9011,9040,9050,9071,9080-9081,9090-9091,9099-9103,9110-9111,9200,9207,9220,9290,9415,9418,9485,9500,9502-9503,9535,9575,9593-9595,9618,9666,9876-9878,9898,9900,9917,9929,9943-9944,9968,9998-10004,10009-10010,10012,10024-10025,10082,10180,10215,10243,10566,10616-10617,10621,10626,10628-10629,10778,11110-11111,11967,12000,12174,12265,12345,13456,13722,13782-13783,14000,14238,14441-14442,15000,15002-15004,15660,15742,16000-16001,16012,16016,16018,16080,16113,16992-16993,17877,17988,18040,18101,18988,19101,19283,19315,19350,19780,19801,19842,20000,20005,20031,20221-20222,20828,21571,22939,23502,24444,24800,25734-25735,26214,27000,27352-27353,27355-27356,27715,28201,30000,30718,30951,31038,31337,32768-32785,33354,33899,34571-34573,35500,38292,40193,40911,41511,42510,44176,44442-44443,44501,45100,48080,49152-49161,49163,49165,49167,49175-49176,49400,49999-50003,50006,50300,50389,50500,50636,50800,51103,51493,52673,52822,52848,52869,54045,54328,55055-55056,55555,55600,56737-56738,57294,57797,58080,60020,60443,61532,61900,62078,63331,64623,64680,65000,65129,65389","type":"syn"},"verbose":{"level":0}}}""")

scan_result1 = json.loads("""{
	"nmaprun": {
		"scaninfo": {
			"_type": "syn",
			"_protocol": "tcp",
			"_numservices": "1000",
			"_services": "1,3-4,6-7,9,13,17,19-26,30,32-33,37,42-43,49,53,70,79-85,88-90,99-100,106,109-111,113,119,125,135,139,143-144,146,161,163,179,199,211-212,222,254-256,259,264,280,301,306,311,340,366,389,406-407,416-417,425,427,443-445,458,464-465,481,497,500,512-515,524,541,543-545,548,554-555,563,587,593,616-617,625,631,636,646,648,666-668,683,687,691,700,705,711,714,720,722,726,749,765,777,783,787,800-801,808,843,873,880,888,898,900-903,911-912,981,987,990,992-993,995,999-1002,1007,1009-1011,1021-1100,1102,1104-1108,1110-1114,1117,1119,1121-1124,1126,1130-1132,1137-1138,1141,1145,1147-1149,1151-1152,1154,1163-1166,1169,1174-1175,1183,1185-1187,1192,1198-1199,1201,1213,1216-1218,1233-1234,1236,1244,1247-1248,1259,1271-1272,1277,1287,1296,1300-1301,1309-1311,1322,1328,1334,1352,1417,1433-1434,1443,1455,1461,1494,1500-1501,1503,1521,1524,1533,1556,1580,1583,1594,1600,1641,1658,1666,1687-1688,1700,1717-1721,1723,1755,1761,1782-1783,1801,1805,1812,1839-1840,1862-1864,1875,1900,1914,1935,1947,1971-1972,1974,1984,1998-2010,2013,2020-2022,2030,2033-2035,2038,2040-2043,2045-2049,2065,2068,2099-2100,2103,2105-2107,2111,2119,2121,2126,2135,2144,2160-2161,2170,2179,2190-2191,2196,2200,2222,2251,2260,2288,2301,2323,2366,2381-2383,2393-2394,2399,2401,2492,2500,2522,2525,2557,2601-2602,2604-2605,2607-2608,2638,2701-2702,2710,2717-2718,2725,2800,2809,2811,2869,2875,2909-2910,2920,2967-2968,2998,3000-3001,3003,3005-3007,3011,3013,3017,3030-3031,3052,3071,3077,3128,3168,3211,3221,3260-3261,3268-3269,3283,3300-3301,3306,3322-3325,3333,3351,3367,3369-3372,3389-3390,3404,3476,3493,3517,3527,3546,3551,3580,3659,3689-3690,3703,3737,3766,3784,3800-3801,3809,3814,3826-3828,3851,3869,3871,3878,3880,3889,3905,3914,3918,3920,3945,3971,3986,3995,3998,4000-4006,4045,4111,4125-4126,4129,4224,4242,4279,4321,4343,4443-4446,4449,4550,4567,4662,4848,4899-4900,4998,5000-5004,5009,5030,5033,5050-5051,5054,5060-5061,5080,5087,5100-5102,5120,5190,5200,5214,5221-5222,5225-5226,5269,5280,5298,5357,5405,5414,5431-5432,5440,5500,5510,5544,5550,5555,5560,5566,5631,5633,5666,5678-5679,5718,5730,5800-5802,5810-5811,5815,5822,5825,5850,5859,5862,5877,5900-5904,5906-5907,5910-5911,5915,5922,5925,5950,5952,5959-5963,5987-5989,5998-6007,6009,6025,6059,6100-6101,6106,6112,6123,6129,6156,6346,6389,6502,6510,6543,6547,6565-6567,6580,6646,6666-6669,6689,6692,6699,6779,6788-6789,6792,6839,6881,6901,6969,7000-7002,7004,7007,7019,7025,7070,7100,7103,7106,7200-7201,7402,7435,7443,7496,7512,7625,7627,7676,7741,7777-7778,7800,7911,7920-7921,7937-7938,7999-8002,8007-8011,8021-8022,8031,8042,8045,8080-8090,8093,8099-8100,8180-8181,8192-8194,8200,8222,8254,8290-8292,8300,8333,8383,8400,8402,8443,8500,8600,8649,8651-8652,8654,8701,8800,8873,8888,8899,8994,9000-9003,9009-9011,9040,9050,9071,9080-9081,9090-9091,9099-9103,9110-9111,9200,9207,9220,9290,9415,9418,9485,9500,9502-9503,9535,9575,9593-9595,9618,9666,9876-9878,9898,9900,9917,9929,9943-9944,9968,9998-10004,10009-10010,10012,10024-10025,10082,10180,10215,10243,10566,10616-10617,10621,10626,10628-10629,10778,11110-11111,11967,12000,12174,12265,12345,13456,13722,13782-13783,14000,14238,14441-14442,15000,15002-15004,15660,15742,16000-16001,16012,16016,16018,16080,16113,16992-16993,17877,17988,18040,18101,18988,19101,19283,19315,19350,19780,19801,19842,20000,20005,20031,20221-20222,20828,21571,22939,23502,24444,24800,25734-25735,26214,27000,27352-27353,27355-27356,27715,28201,30000,30718,30951,31038,31337,32768-32785,33354,33899,34571-34573,35500,38292,40193,40911,41511,42510,44176,44442-44443,44501,45100,48080,49152-49161,49163,49165,49167,49175-49176,49400,49999-50003,50006,50300,50389,50500,50636,50800,51103,51493,52673,52822,52848,52869,54045,54328,55055-55056,55555,55600,56737-56738,57294,57797,58080,60020,60443,61532,61900,62078,63331,64623,64680,65000,65129,65389"
		},
		"verbose": {
			"_level": "0"
		},
		"debugging": {
			"_level": "0"
		},
		"taskprogress": {
			"_task": "Service scan",
			"_time": "1730459303",
			"_percent": "0.00"
		},
		"host": {
			"status": {
				"_state": "up",
				"_reason": "localhost-response",
				"_reason_ttl": "0"
			},
			"address": {
				"_addr": "10.10.10.75",
				"_addrtype": "ipv4"
			},
			"hostnames": {
				"hostname": {
					"_name": "sohaibs-techwards-thinkpad-e15-gen-2",
					"_type": "PTR"
				}
			},
			"ports": {
				"extraports": {
					"extrareasons": {
						"_reason": "resets",
						"_count": "999"
					},
					"_state": "closed",
					"_count": "999"
				},
				"port": {
					"state": {
						"_state": "open",
						"_reason": "syn-ack",
						"_reason_ttl": "64"
					},
					"service": {
						"cpe": "cpe:/a:apache:http_server:2.4.52",
						"_name": "http",
						"_product": "Apache httpd",
						"_version": "2.4.52",
						"_extrainfo": "(Ubuntu)",
						"_method": "probed",
						"_conf": "10"
					},
					"_protocol": "tcp",
					"_portid": "80"
				}
			},
			"os": {
				"portused": [
					{
						"_state": "open",
						"_proto": "tcp",
						"_portid": "80"
					},
					{
						"_state": "closed",
						"_proto": "tcp",
						"_portid": "1"
					},
					{
						"_state": "closed",
						"_proto": "udp",
						"_portid": "31166"
					}
				],
				"osmatch": {
					"osclass": {
						"cpe": "cpe:/o:linux:linux_kernel:2.6.32",
						"_type": "general purpose",
						"_vendor": "Linux",
						"_osfamily": "Linux",
						"_osgen": "2.6.X",
						"_accuracy": "100"
					},
					"_name": "Linux 2.6.32",
					"_accuracy": "100",
					"_line": "55543"
				}
			},
			"uptime": {
				"_seconds": "129941",
				"_lastboot": "Thu Oct 31 04:02:43 2024"
			},
			"distance": {
				"_value": "0"
			},
			"tcpsequence": {
				"_index": "259",
				"_difficulty": "Good luck!",
				"_values": "4093618E,4A261C66,2B3349D7,2696BB27,5C28C195,AD80EAD4"
			},
			"ipidsequence": {
				"_class": "All zeros",
				"_values": "0,0,0,0,0,0"
			},
			"tcptssequence": {
				"_class": "1000HZ",
				"_values": "7BEBA8E,7BEBAF2,7BEBB56,7BEBBBA,7BEBC1E,7BEBC82"
			},
			"times": {
				"_srtt": "24",
				"_rttvar": "6",
				"_to": "100000"
			},
			"_starttime": "1730459297",
			"_endtime": "1730459304"
		},
		"runstats": {
			"finished": {
				"_time": "1730459304",
				"_timestr": "Fri Nov  1 16:08:24 2024",
				"_elapsed": "7.71",
				"_summary": "Nmap done at Fri Nov  1 16:08:24 2024; 1 IP address (1 host up) scanned in 7.71 seconds",
				"_exit": "success"
			},
			"hosts": {
				"_up": "1",
				"_down": "0",
				"_total": "1"
			}
		},
		"_scanner": "nmap",
		"_args": "nmap -O -sV -oX res.xml 10.10.10.75",
		"_start": "1730459297",
		"_startstr": "Fri Nov  1 16:08:17 2024",
		"_version": "7.80",
		"_xmloutputversion": "1.04"
	}
}""")

print(type(scan_result1))
cleaned_data = clean_and_prepare_data(scan_result1)

# Display cleaned data
print("Cleaned Data:")
for key, value in cleaned_data.items():
    print(f"{key}: {value}")